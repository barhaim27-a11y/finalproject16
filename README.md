# üß† Parkinsons ‚Äì ML App (v8.4)

Streamlit app for Parkinson‚Äôs disease modeling & prediction.  
Includes: EDA, single/multi training with metrics & curves, best-model dashboard, prediction (single/batch), retrain with **promote only if better**, and exports to CSV/XLSX.  
**Production (baseline) model uses `opt_thr` from metadata** ‚Äì so predictions align with your notebook.

## üóÇ Project Structure
```
.
‚îú‚îÄ‚îÄ streamlit_app.py
‚îú‚îÄ‚îÄ model_pipeline.py
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ parkinsons.csv           # UCI dataset (replace with real CSV if needed)
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ best_model.joblib        # production model (set/upload in Best tab)
‚îî‚îÄ‚îÄ assets/
    ‚îú‚îÄ‚îÄ best_model.json          # metadata (e.g., {"opt_thr": 0.47, ...})
    ‚îú‚îÄ‚îÄ roc_best_eval.png        # generated by Best tab
    ‚îú‚îÄ‚îÄ pr_best_eval.png
    ‚îî‚îÄ‚îÄ cm_best_eval.png
```

> If `data/parkinsons.csv` is missing, the app synthesizes a small demo dataset so it can boot. Replace with the real UCI CSV for actual results.

## üöÄ Run
```bash
pip install -r requirements.txt
streamlit run streamlit_app.py
```

## üîÅ Baseline / Production model
- **From your EDA notebook** save:
  ```python
  import joblib, json, os
  os.makedirs("models", exist_ok=True)
  joblib.dump(best_model, "models/best_model.joblib")  # your selected pipeline/estimator
  os.makedirs("assets", exist_ok=True)
  meta = {"source":"EDA_notebook","opt_thr":0.5}        # put your optimal threshold here
  open("assets/best_model.json","w",encoding="utf-8").write(json.dumps(meta, ensure_ascii=False, indent=2))
  ```
- In the app ‚Üí **Best Dashboard** ‚Üí Upload `.joblib` (+ optional `best_model.json`) ‚Üí Set as production.  
  Tabs **Best**/**Predict** use only this production model (with `opt_thr`).

## üß™ Tabs Overview
- **DATA/EDA**: Head of the data, missing/describe, correlation heatmap, export EDA.xlsx.
- **Single Model**: Train one model ‚Üí metrics (ROC-AUC, Accuracy, F1, Precision, Recall, `opt_thr`), CV means, ROC/PR/CM, export results.
- **Multi Compare**: Train multiple models ‚Üí leaderboard table (‚≠ê best), bar chart by metric, ROC/PR overlays, export leaderboard.
- **Best Dashboard**: Evaluate production model on current data, show metrics + ROC/PR/CM, show metadata and runs log.
- **Predict**: Use production model for preview, single-form prediction, or batch CSV; export predictions.
- **Retrain**: Train (single/multi) on uploaded training CSV; compare to production on **the same data**; **Promote** only if strictly better (by chosen metric).

## üß∞ Notes
- KerasNN/XGBoost are optional; if not available, app falls back gracefully to classic models.
- Feature list & grids are controlled in `config.py`.
- All exports are created in-memory and downloadable as CSV/XLSX.
